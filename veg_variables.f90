!======================================================================!
module veg_variables
!----------------------------------------------------------------------!
! Definitions for vegetation-related variables.
!----------------------------------------------------------------------!
use control_parameters
!----------------------------------------------------------------------!
implicit none
save
real*8 :: cna
!----------------------------------------------------------------------!
real*8, allocatable :: vdata (:,:,:) ! Frac of grd bx of veg type 1-11
                                     ! (fraction)
integer, allocatable :: vdata_in (:,:,:)
!----------------------------------------------------------------------!
real*8, allocatable :: afb (:,:) ! Bare fraction of grid box  (fraction)
!----------------------------------------------------------------------!
! LAI coefficients. 1 = average leaf area index;
!                   2 = real amplitude of leaf area index;
!                   3 = imaginary amplitude of leaf area index.
!----------------------------------------------------------------------!
real*8, allocatable :: ala  (:,:,:)
real*8, allocatable :: alaf (:,:,:,:)
!----------------------------------------------------------------------!
! cs coefficients. 1 = average stomatal conductance;
!                  2 = real amplitude of stomatal conductance;
!                  3 = imaginary amplitude of stomatal conductance.
!----------------------------------------------------------------------!
real*8, allocatable :: acs (:,:,:)
!----------------------------------------------------------------------!
real*8, allocatable :: avh (:,:) ! Vegetation height                 (m)
real*8, allocatable :: afr (:,:,:) ! Root in soil layers      (fraction)
!----------------------------------------------------------------------!
! Carbon pools (kgC/m^2).
! 1 labile
! 2 structure
! 3 litter
! 4 SOM
!----------------------------------------------------------------------!
real*8, allocatable :: cm (:,:,:) ! (im,jm,ncpools)
real*8, allocatable :: cland (:)
!----------------------------------------------------------------------!
! Leaf area index (m^2/m^2).
!  1 = tundra
!  2 = grassland
!  3 = shrub/grassland
!  4 = tree/grassland
!  5 = deciduous forest
!  6 = evergreen forest
!  7 = rainforest
!  8 = cultivation
!----------------------------------------------------------------------!
real*8, allocatable :: alaif   (:,:,:) ! Each plant type
real*8, allocatable :: alait   (:)     ! Each plant type
real*8, allocatable :: aij_lai (:,:,:) ! Vegetated fraction
real*8 :: alai                         ! Vegetated fraction
real*8 :: alaie                        ! Effective in vegetated fraction
!----------------------------------------------------------------------!
! Fraction of PAR absorbed (fraction).
!----------------------------------------------------------------------!
real*8, allocatable :: fparf    (:,:,:)
real*8, allocatable :: fpart    (:)
real*8, allocatable :: aij_fpar (:,:,:)
!----------------------------------------------------------------------!
integer :: i_bare ! 1=bare fraction; 2=no bare fraction        (n)
integer :: i_vege ! 1=vegetated fraction; 2=no vegetated frac  (n)
!----------------------------------------------------------------------!
logical :: process_bare, process_vege
!----------------------------------------------------------------------!
real*8 :: cosday,sinday
real*8 :: fb,fv ! Fractions of bare and vegetated surf  (fraction)
real*8 :: vh    ! Vegetation height                            (m)
real*8 :: cnc   ! Canopy conductance                    (m/s)
real*8, allocatable :: fr (:) ! Root in each layer (fraction)
!----------------------------------------------------------------------!
real*8, allocatable :: fc (:) ! Canopy water fluxes (m/s)
!----------------------------------------------------------------------!
! Overall transpiration efficiency (fraction).
!----------------------------------------------------------------------!
real*8 :: betad
!----------------------------------------------------------------------!
! Overall soil moisture impact on physiology (fraction).
!----------------------------------------------------------------------!
real*8 :: f_swp
!----------------------------------------------------------------------!
! Moisture vapour deficit impact on stomatal conductance (fraction).
!----------------------------------------------------------------------!
real*8 :: f_dq
!----------------------------------------------------------------------!
! Overall transpiration efficiency diagnostic (fraction).
!----------------------------------------------------------------------!
real*8, allocatable :: betad_ij (:,:)
!----------------------------------------------------------------------!
! Overall transpiration efficiency diagnostic (fraction).
!----------------------------------------------------------------------!
real*8, allocatable :: aij_betad (:,:)
!----------------------------------------------------------------------!
! Gross primary production (kgC/m2/s).
!----------------------------------------------------------------------!
real*8 :: gpp
!----------------------------------------------------------------------!
! Total gross primary production (kgC/m2).
!----------------------------------------------------------------------!
real*8 :: agpp
!----------------------------------------------------------------------!
! Net primary production (kgC/m2/s).
!----------------------------------------------------------------------!
real*8 :: npp
!----------------------------------------------------------------------!
! Net exchange with atmosphere (+ve up) (kgC/m2/s).
!----------------------------------------------------------------------!
real*8 :: nee
!----------------------------------------------------------------------!
! Total net primary production (kgC/m2).
!----------------------------------------------------------------------!
real*8 :: anpp
!----------------------------------------------------------------------!
! Total net exchange with atmosphere (+ve up) (kgC/m2).
!----------------------------------------------------------------------!
real*8 :: anee
!----------------------------------------------------------------------!
! Photorespiratory compensation point (Pa).
!----------------------------------------------------------------------!
real*8 :: pcp
!----------------------------------------------------------------------!
! Michaelis-Menten constant for carboxylation (Pa).
!----------------------------------------------------------------------!
real*8 :: kc
!----------------------------------------------------------------------!
! Michaelis-Menten constant for oxygenation (Pa).
!----------------------------------------------------------------------!
real*8 :: ko
!----------------------------------------------------------------------!
! Combined Michaelis-Menten constant for net carboxylation (Pa).
!----------------------------------------------------------------------!
real*8 :: km
!----------------------------------------------------------------------!
! Scaling coefficient for N-dependence of e-transport (ratio).
!----------------------------------------------------------------------!
real*8 :: n1
!----------------------------------------------------------------------!
! Scaling coefficient for N-dependence of carboxylation (ratio).
!----------------------------------------------------------------------!
real*8 :: n2
!----------------------------------------------------------------------!
! Foliage N (umol/m^2)
!----------------------------------------------------------------------!
real*8, allocatable :: nl (:)
!----------------------------------------------------------------------!
! Ratio of foliage chlorophyll to N (umol/mol)
!----------------------------------------------------------------------!
real*8, allocatable :: n3 (:)
!----------------------------------------------------------------------!
! Foliage light transmission (fraction)
!----------------------------------------------------------------------!
real*8, allocatable :: fabsb (:)
!------------------------------------------------------------------!
! CO2 partial pressure at surface level (Pa).
!------------------------------------------------------------------!
real*8 :: capa
!------------------------------------------------------------------!
! Canopy mitochondrial respiration (umol/m^2/s).
!------------------------------------------------------------------!
real*8 :: rpcrn
!----------------------------------------------------------------------!
! Canopy net photosynthesis (umol/m^2/s).
!----------------------------------------------------------------------!
real*8 :: acann
!----------------------------------------------------------------------!
! Autotrophic respiration (kgC/m^2/s).
!----------------------------------------------------------------------!
real*8 :: ra
!----------------------------------------------------------------------!
! Heterotrophic SOM respiration (kgC/m^2/s).
!----------------------------------------------------------------------!
real*8 :: rh_som
!----------------------------------------------------------------------!
! Heterotrophic litter respiration (kgC/m^2/s).
!----------------------------------------------------------------------!
real*8 :: rh_clit
!----------------------------------------------------------------------!
! Structural growth (kgC/m^2/s)
!----------------------------------------------------------------------!
real*8 :: cgrow
!----------------------------------------------------------------------!
! Structure turnover (kgC/m^2/s)
!----------------------------------------------------------------------!
real*8 :: clit
!----------------------------------------------------------------------!
! Litter transformation so SOM (kgC/m^2/s)
!----------------------------------------------------------------------!
real*8 :: clit_trans
!----------------------------------------------------------------------!
! Internal leaf CO2 (mol/m^3).
!----------------------------------------------------------------------!
real*8 :: veg_ci
!----------------------------------------------------------------------!
! Accumulated monthly carbon masses (kgC/m^2).
!----------------------------------------------------------------------!
real*8, allocatable :: aij_cm (:,:,:)
!----------------------------------------------------------------------!
! Gross primary productivity acc to month (kgC/m2/mo).
!----------------------------------------------------------------------!
real*8, allocatable :: aij_gpp (:,:)
!----------------------------------------------------------------------!
! Net primary productivity acc to month (kgC/m2/mo.).
!----------------------------------------------------------------------!
real*8, allocatable :: aij_npp (:,:)
!----------------------------------------------------------------------!
! Net exchange with atmos. (+ve up) acc to month (kgC/m2/mo.).
!----------------------------------------------------------------------!
real*8, allocatable :: aij_nee (:,:)
!----------------------------------------------------------------------!
! Internal leaf CO2 (mol/m^3).
!----------------------------------------------------------------------!
real*8, allocatable :: veg_ci_ij (:,:)
!----------------------------------------------------------------------!
! Canopy surface water vapour mixing ratio (kg/kg).
!----------------------------------------------------------------------!
real*8, allocatable :: qfol_ij (:,:)
!----------------------------------------------------------------------!
! Minimum canopy stomatal resistance (m/s).
!----------------------------------------------------------------------!
real*8 :: rs
!----------------------------------------------------------------------!
! Specific humidity of vegetation (kg/kg).
!----------------------------------------------------------------------!
real*8 :: qv
!----------------------------------------------------------------------!
! Specific humidity of vegetation canopy surface (kg/kg).
!----------------------------------------------------------------------!
real*8 :: qf
!----------------------------------------------------------------------!
! Total canopy transmittance of shortwave (fraction).
!----------------------------------------------------------------------!
real*8 :: trans_sw
!----------------------------------------------------------------------!
end module veg_variables
!======================================================================!
