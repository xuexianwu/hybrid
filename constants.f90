!======================================================================!
module constants
!----------------------------------------------------------------------!
! Definitions for physical constants and useful numbers.
!----------------------------------------------------------------------!
use control_parameters
!----------------------------------------------------------------------!
implicit none
save
!----------------------------------------------------------------------!
! pi.
!----------------------------------------------------------------------!
real*8, parameter :: pi = 3.1415926535897932d0
!----------------------------------------------------------------------!
! 2*pi.
!----------------------------------------------------------------------!
real*8, parameter :: twopi = 2.0d0 * pi
!----------------------------------------------------------------------!
! 1 for ocassional use as argument.
!----------------------------------------------------------------------!
real*8, parameter :: one = 1.0d0
!----------------------------------------------------------------------!
! 0 for ocassional use as argument.
!----------------------------------------------------------------------!
real*8, parameter :: zero = 0.0d0
!----------------------------------------------------------------------!
! Physical constants.
!----------------------------------------------------------------------!
! Stefan-Boltzmann constant (W/m^2 K^4).
!----------------------------------------------------------------------!
real*8, parameter :: stbo = 5.67051d-8 !current best estimate
!----------------------------------------------------------------------!
!**** Latent heats:
!**** Note that for energy conservation the efective latent heat at any
!**** temperature must follow these formulae (assuming a reference
!**** temperature of 0 Celcius, and constant specific heats).
!**** If specific heats vary as a function of temperature, the extra
!**** term becomes an integral
!**** lhe(T) = lhe(0) + (shv-shw) T (in C)
!**** lhm(T) = lhm(0) + (shw-shi) T (in C)
!**** lhs(T) = lhs(0) + (shv-shi) T (in C)
!----------------------------------------------------------------------!
! latent heat of evap at 0 C (2.5008d6 J/kg).
!----------------------------------------------------------------------!
real*8, parameter :: lhe = 2.5d6
!----------------------------------------------------------------------!
! latent heat of melt at 0 C (334590 J/kg).
!----------------------------------------------------------------------!
real*8, parameter :: lhm = 3.34d5
!----------------------------------------------------------------------!
! 1/lhm.
!----------------------------------------------------------------------!
real*8, parameter :: bylhm = 1.0D0 / lhm
!----------------------------------------------------------------------!
! latent heat of sublimation at 0 C (J/kg).
!----------------------------------------------------------------------!
real*8, parameter :: lhs = lhe + lhm
!----------------------------------------------------------------------!
! Density of pure water (1000 kg/m^3).
!----------------------------------------------------------------------!
real*8, parameter :: rhow = 1.0d3
!----------------------------------------------------------------------!
! Latent heat of evaporation (J/m^3)
!----------------------------------------------------------------------!
real*8, parameter :: elh = lhe * rhow
!----------------------------------------------------------------------!
! Freezing point of water at 1 atm (273.16 K)
!----------------------------------------------------------------------!
real*8, parameter :: tf = 273.16d0
!----------------------------------------------------------------------!
! Heat capacity of water (at 20 C) (4185 J/(kg degC)).
!----------------------------------------------------------------------!
real*8, parameter :: shw_kg = 4185.0d0
!----------------------------------------------------------------------!
! Heat capacity of water (at 20 C) (J/m^3 C).
!----------------------------------------------------------------------!
real*8, parameter :: shw = shw_kg * rhow
!----------------------------------------------------------------------!
! Heat capacity of pure ice (at 0 C) (2060 J/kg C)
!----------------------------------------------------------------------!
real*8, parameter :: shi_kg  = 2060.0d0
!----------------------------------------------------------------------!
! Heat capacity of pure ice (at 0 C) (2060 J/m^3 C)
!----------------------------------------------------------------------!
real*8, parameter :: shi  = shi_kg * rhow
!----------------------------------------------------------------------!
!**** RGAS = R/M_A = 1000* 8.314510 J/mol K /28.9655 g/mol
!**** For values of CO2 much larger than present day (> 4x conc)
!**** the molecular weight of dry air M_A could change.
!**** Assume that M_O2 = 31.9988 and M_CO2 = 44.00995
!**** and current percentages 20.946% and 0.0350% (US Stand. Atm.)
!**** Assuming CO2 displaces other gases equally M_A=28.9602 + n*0.00527
!**** where n is multiple of present day CO2 conc (350 ppm)
!**** For 4xCO2  M_A = 28.9813  => rgas = 286.89
!**** For 10xCO2 M_A = 29.0129  => rgas = 286.58
!----------------------------------------------------------------------!
! Gas constant (8.314510 J/mol K)
!----------------------------------------------------------------------!
real*8, parameter :: gasc = 8.314510d0
!----------------------------------------------------------------------!
!  1/gasc.
!----------------------------------------------------------------------!
real*8, parameter :: bygasc = 1.0d0 / gasc
!----------------------------------------------------------------------!
! Molecular weight of dry air (28.9655 g/mol).
!----------------------------------------------------------------------!
real*8, parameter :: mair = 28.9655d0
!----------------------------------------------------------------------!
! Gas constant (287.05 J/K kg).
!----------------------------------------------------------------------!
real*8,parameter :: rgas = 1.0d3 * gasc / mair ! = 287.05...
!----------------------------------------------------------------------!
! Molecular weight of water vapour.
!----------------------------------------------------------------------!
real*8, parameter :: mwat = 18.015d0
!----------------------------------------------------------------------!
! Gas constant for water vapour (461.5 J/K kg)
!**** defined as R/M_W = 1000* 8.314510 J/mol K /18.015 g/mol
!----------------------------------------------------------------------!
real*8, parameter :: rvap = 1.0d3 * gasc / mwat ! = 461.5...
!----------------------------------------------------------------------!
! Mass ratio of air to water vapour (0.62197).
!----------------------------------------------------------------------!
real*8, parameter :: mrat = mwat / mair    ! = 0.62197....
!----------------------------------------------------------------------!
! 1/mrat (1.6078).
!----------------------------------------------------------------------!
real*8, parameter :: bymrat = 1.0d0 / mrat    ! = 1.6078....
!----------------------------------------------------------------------!
! Coeff. of humidity in virtual temperature defn. (0.6078).
!----------------------------------------------------------------------!
real*8, parameter :: deltx = bymrat - 1.0d0   ! = 0.6078....
!----------------------------------------------------------------------!
! Ratio of specific heats at const. press. and vol. (=1.401)
!----------------------------------------------------------------------!
real*8, parameter :: srat = 1.401d0
!----------------------------------------------------------------------!
! Ideal gas law exponent for dry air (.2862)
!**** kapa = (g-1)/g where g=1.401 = c_p/c_v
!----------------------------------------------------------------------!
real*8, parameter :: kapa = (srat - 1.0d0) / srat  ! =.2862....
!----------------------------------------------------------------------!
! Specific heat of dry air (const. pres.) (rgas/kapa J/kg C)
!----------------------------------------------------------------------!
real*8, parameter :: sha = rgas / kapa
!----------------------------------------------------------------------!
! Latent heat of melt (J/m^3).
!----------------------------------------------------------------------!
real*8, parameter :: fsn = lhm * rhow
!----------------------------------------------------------------------!
! Specific gravity of snow (relative to water).
!----------------------------------------------------------------------!
real*8, parameter :: spgsn = 0.1d0
!----------------------------------------------------------------------!
! Specific heat capacities of soil textures (sand loam clay peat rock).
!----------------------------------------------------------------------!
real*8, parameter :: shcap (ntextures) = (/ 2.0d6, 2.0d6, 2.0d6, &
&                                           2.5d6, 2.4d6 /)
!----------------------------------------------------------------------!
! Gravitational accelaration (9.80665 m/s^2)
! SI reference gravity (at 45 deg) = 9.80665
!----------------------------------------------------------------------!
real*8, parameter :: grav = 9.80665d0
!----------------------------------------------------------------------!
! 1/grav.
!----------------------------------------------------------------------!
real*8, parameter :: bygrav = 1.0d0 / grav
!----------------------------------------------------------------------!
! Value of volumetric moisture content (i.e. relative theta) at
! hlm (j) in texture i (fraction).
!----------------------------------------------------------------------!
real*8 :: thm (0:64,ntextures-1)
!----------------------------------------------------------------------!
! Soil hydraulic conductivity at j''th h point for texture i (kg/m^2/s)
!----------------------------------------------------------------------!
real*8 :: xklm (0:64,ntextures-1)
!----------------------------------------------------------------------!
! Soil moisture diffusivity (kg/m/s)
!----------------------------------------------------------------------!
real*8 :: dlm (0:64,ntextures-1)
!----------------------------------------------------------------------!
! Matric potentials for thm from 0 (at j=0) to hmin (at j=nth)(m).
!----------------------------------------------------------------------!
real*8 :: hlm (0:64)
!----------------------------------------------------------------------!
! Used to calculate soil properties in hl0 (log of 10 to base e).
!----------------------------------------------------------------------!
real*8, parameter :: c = 2.3025851d0
!----------------------------------------------------------------------!
! Coefficients for calculating matric potentials for different soil
! textures.
!----------------------------------------------------------------------!
      real*8, dimension(4,ntextures-1), parameter :: a=reshape( &
     &     (/ &                  ! matric potential coefficients for
     &     .2514d0,  0.0136d0, -2.8319d0,  0.5958d0, & ! sand
     &     .1481d0,  1.8726d0,  0.1025d0, -3.6416d0, & ! loam
     &     .2484d0,  2.4842d0,  0.4583d0, -3.9470d0, & ! clay
     &     .8781d0, -5.1816d0, 13.2385d0,-11.9501d0/), & ! peat
     &     (/4,ntextures-1/))
!----------------------------------------------------------------------!
! Coefficients for calculating soil moisture conductivities for
! different soil textures.
!----------------------------------------------------------------------!
      real*8, dimension(4,ntextures-1), parameter :: b=reshape( &
     &     (/ &                  ! conductivity coefficients for
     &     -0.4910d0, -9.8945d0,  9.7976d0, -3.2211d0, & ! sand
     &     -0.3238d0,-12.9013d0,  3.4247d0,  4.4929d0, & ! loam
     &     -0.5187d0,-13.4246d0,  2.8899d0,  5.0642d0, & ! clay
     &     -3.0848d0,  9.5497d0,-26.2868d0, 16.6930d0/), & ! peat
     &     (/4,ntextures-1/))
!----------------------------------------------------------------------!
! Coefficients for calculating soil moisture diffusivities for
! different soil textures.
!----------------------------------------------------------------------!
      real*8, dimension(4,ntextures-1), parameter :: pq=reshape( &
     &     (/ &                   ! diffusivity coefficients for
     &     -0.1800d0, -7.9999d0,  5.5685d0, -1.8868d0, & ! sand
     &     -0.1000d0,-10.0085d0,  3.6752d0,  1.2304d0, & ! loam
     &     -0.1951d0, -9.7055d0,  2.7418d0,  2.0054d0, & ! clay
     &     -2.1220d0,  5.9983d0,-16.9824d0,  8.7615d0/), & ! peat
     &     (/4,ntextures-1/))
!----------------------------------------------------------------------!
! Saturated volumetric soil moisture for each texture          (m^3/m^3)
!----------------------------------------------------------------------!
real*8, parameter :: sat (ntextures-1) = (/.394d0,.537d0,.577d0,.885d0/)
!----------------------------------------------------------------------!
! Tolerance for calculation of thm (only used as diagnostic).
!----------------------------------------------------------------------!
real*8, parameter :: xtol = 1.0d-6
!----------------------------------------------------------------------!
! Used to calculated soil moisture conductivities.
!----------------------------------------------------------------------!
real*8, parameter :: sxtn = 16.0d0
!----------------------------------------------------------------------!
!---  parameters for different types of vegetation
!---          tundr  grass  shrub  trees  decid evrgr  rainf crops
!----------------------------------------------------------------------!
! Max. and min LAI (m2/m2).
!----------------------------------------------------------------------!
real*8, parameter :: alamax (8) = &
&     (/ 1.5d0, 2.0d0, 2.5d0, 4.0d0, 6.0d0,10.0d0,8.0d0,4.5d0/)
real*8, parameter :: alamin (8) = &
&     (/ 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 8.0d0,6.0d0,1.0d0/)
!----------------------------------------------------------------------!
! Root profile coefficients.
!----------------------------------------------------------------------!
real*8, parameter :: aroot (8) = &
& (/ 12.5d0, 0.9d0, 0.8d0,0.25d0,0.25d0,0.25d0,1.1d0,0.9d0 /)
real*8, parameter :: broot (8) = &
& (/  1.0d0, 0.9d0, 0.4d0,2.00d0,2.00d0,2.00d0,0.4d0,0.9d0 /)
!----------------------------------------------------------------------!
! Minimum stomatal resistances (s/m).
!----------------------------------------------------------------------!
real*8, parameter :: rsar (8) = &
& (/100.0d0, 100.0d0, 200.0d0, 200.0d0, &
&   200.0d0, 300.0d0,250.0d0, 125.0d0/)
!----------------------------------------------------------------------!
! Vegetation heights (m).
!----------------------------------------------------------------------!
real*8, parameter :: vhght (8) = &
&  (/ 0.1d0, 1.5d0, 5.0d0, 15.0d0, 20.0d0, 30.0d0, 25.0d0, 1.75d0 /)
!----------------------------------------------------------------------!
! Julian day of peak leaf area (day).
!----------------------------------------------------------------------!
integer, parameter :: laday (8) = &
&     (/ 196,  196,  196,  196,  196,  196,  196,  196/)
!----------------------------------------------------------------------!
! Astronomical constants.
!----------------------------------------------------------------------!
! Seconds per day (s)
!----------------------------------------------------------------------!
real*8,parameter :: sday = 86400.0d0
!----------------------------------------------------------------------!
! Earth days per year (day).
!----------------------------------------------------------------------!
real*8, parameter :: edpery = 365.0d0
!----------------------------------------------------------------------!
! Hours per day (hr)
!----------------------------------------------------------------------!
integer, parameter :: hr_in_day = 24
!----------------------------------------------------------------------!
! Calendar-related terms (simplified).
!----------------------------------------------------------------------!
! Julian days per year (days).
!----------------------------------------------------------------------!
integer, parameter :: jdpery = 365
!----------------------------------------------------------------------!
! Months per year (months).
!----------------------------------------------------------------------!
integer, parameter :: jmpery =  12
!----------------------------------------------------------------------!
! Last Julian day in month.
!----------------------------------------------------------------------!
integer :: jdendofm (0:jmpery) = &
& (/0,31,59,90,120,151,181,212,243,273,304,334,365/)
!----------------------------------------------------------------------!
! Converts deg > rad (pi / 180).
!----------------------------------------------------------------------!
real*8, parameter :: rfac = 17.4533e-3
!----------------------------------------------------------------------!
end module constants
!======================================================================!
